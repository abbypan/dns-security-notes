# 一种用户查询域名信息隐藏方案

DNS本质上是一种查表型的信息服务，在传统层次型的DNS解析架构方案中，递归服务器掌握了最关键的用户域名访问信息。DNSCrypt方案仅解决了用户到递归的链路隐私问题，尽管用户可以通过混淆发包查询多个域名、或者代理查询方式进行部分隐藏，但是用户的真实域名访问兴趣仍可在递归日志中留存记录，存在某些溯源关联的路径依赖。

因此，与现实网络结合的用户侧DNS隐私保护增强，还需要递归侧热点域名的缓存信息有着更广泛的分发共享网络。

例如，构建一种用户查询域名信息隐藏方案：

## 递归主动参与热点域名信息分发

1. 类似杀毒软件的病毒特征数据更新模式，递归服务器每分钟更新发布热点域名数据。

2. 客户端运行独立的递归缓存更新软件，直接获取热点域名信息。此时，递归无法直接获知用户对热点互联网业务的访问兴趣。

## 客户端协作网络查询长尾域名

1. 客户端接入P2P协作式域名查询网络，例如基于chord构建。

2. 发起查询的客户端节点根据<TIMESTAMP，QNAME，QTYPE>生成唯一的key值。

3. 查询节点在chord网络中根据key值定位到该时刻系统分发负责此项查询的对等目标节点、或节点集合。

4. 如果对等目标节点没有该key值对应的dns应答缓存，则目标节点需要调用自身、或者相关邻居合作节点启动DNS查询，获取<TIMESTAMP，QNAME，QTYPE>的相关应答信息。

5. 由于不同域名查询频度不同，需要进一步考虑该协作式查询网络节点负载均衡策略。此外，DNS应答往往随着地区运营商的不同返回智能解析结果，应答数据集中还可以加入<AREA, ISP>等辅助信息。

6. 由于恶意节点加入的安全问题，需要综合多个对等节点提供的应答信息投票进行综合评估，或引入更严格的节点信誉度评分机制等等。

##  分析

理论上的好处：能够避免递归服务器对客户端的域名查询信息进行监测分析，从而规避“用户<->递归”层面的隐私泄漏问题。结合现有的 DNS 解析架构形成一个客户端协作网络，减少递归对于用户的集中式窥探可能。

产品上不实用的原因：配个DNS就能搞定的事，大部分人不会再去装一个专用client。
